<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Group | Workflow</title>

    <!-- Disable tap highlight on IE -->
    <meta name="msapplication-tap-highlight" content="no">

    <!-- Web Application Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Friendly Chat">
    <meta name="theme-color" content="#303F9F">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Friendly Chat">
    <meta name="apple-mobile-web-app-status-bar-style" content="#303F9F">

    <!-- Tile icon for Win8 -->
    <meta name="msapplication-TileColor" content="#3372DF">
    <meta name="msapplication-navbutton-color" content="#303F9F">

    <style>
        #init {
            position: fixed;
            z-index: 999;
            width: 100%;
            height: 100%;
            background-color: #f0f0f0;
            -moz-user-select: none;
            -webkit-user-select: none;
            user-select: none;
            display: flex;
            align-items: center;
            justify-content: center;
            display: -webkit-box;
            display: -webkit-flex;
            -webkit-align-items: center;
            -webkit-justify-content: center;
            flex-direction: column;
            -webkit-flex-direction: column;
        }

        .spinner-container {
            -webkit-animation: rotate 2s linear infinite;
            animation: rotate 2s linear infinite;
            z-index: 2;
        }

        .spinner-path {
            stroke-dasharray: 1, 150;
            stroke-dashoffset: 0;
            stroke: #acb9bf;
            stroke-linecap: round;
            -webkit-animation: dash 1.5s ease-in-out infinite;
            animation: dash 1.5s ease-in-out infinite;
        }

        @keyframes rotate {
            100% {
                transform: rotate(360deg);
            }
        }

        @-webkit-keyframes rotate {
            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes dash {
            0% {
                stroke-dasharray: 1, 150;
                stroke-dashoffset: 0;
            }

            50% {
                stroke-dasharray: 90, 150;
                stroke-dashoffset: -35;
            }

            100% {
                stroke-dasharray: 90, 150;
                stroke-dashoffset: -124;
            }
        }

        @-webkit-keyframes dash {
            0% {
                stroke-dasharray: 1, 150;
                stroke-dashoffset: 0;
            }

            50% {
                stroke-dasharray: 90, 150;
                stroke-dashoffset: -35;
            }

            100% {
                stroke-dasharray: 90, 150;
                stroke-dashoffset: -124;
            }
        }
    </style>

    <link rel="stylesheet" href="./base.css">
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./assets/css/hamburger.css">


</head>

<body>

    <div id="init">
        <svg class="spinner-container" width="50" height="50" viewBox="0 0 44 44">
            <circle class="spinner-path" cx="22" cy="22" r="20" fill="none" stroke-width="4"></circle>
        </svg>
    </div>
    <div id="auth" class="pfx t0 h100vh w100vw">
        <div class="p12 w100 h100 fl-c fl-d-cl">
            <h1 class="p12 lhinit" style="padding-bottom: 2rem;">Login To Start Your <span
                    style="color: #6e00ff;">Work</span> Flow</h1>
            <button id="sign-in" type="button" class="login-with-google-btn cp">
                Sign in with Google
            </button>
        </div>
    </div>

    <div id="app">

        <nav>
            <div class="menu-container h100 w100">
                <div id="fallback" class="fallback"></div>
                <div class="card card-sm fl-c fl-j-fs fl-d-cl pfx w100 dsp-none">
                    <div class="w100 fl-c fl-j-fs">
                        <div class="toggleMenu" id="toggle">
                            <div class="burger hamburger" id="burger">
                                <span class="line"></span>
                                <span class="line"></span>
                                <span class="line"></span>
                            </div>
                        </div>
                        <div class="brand-sm">Group</div>
                    </div>
                    <div class="prel w100 fl-c tabs">
                        <div class="sliderHead active fl-c w100">Chat</div>
                        <div class="sliderHead fl-c w100">Group</div>
                        <div class="sliderLine pabs"></div>
                    </div>
                </div>
                <div id="nav" class="card w100 h100 fl-c fl-d-cl fl-j-sb">
                    <!-- users picture element -->
                    <div class="w100 fl-c">
                        <div class="menu-brand fl-c">
                            <div class="menu-item" id="user-pic"></div>
                        </div>
                    </div>
                    <!-- users picture element -->
                    <div class="fl-c fl-d-cl fl-j-sb w100">
                        <div class="menu-brand fl-c curr-menu active">
                            <div class="menu-item cp control fl-c w100" data-control="1">
                                <img src="./assets/icons/chat-o.svg" alt="">
                            </div>
                        </div>
                        <div class="menu-brand fl-c">
                            <div class="menu-item cp control fl-c w100" data-control="2">
                                <img src="./assets/icons/user-add-o.svg" alt="">
                            </div>
                        </div>
                        <div class="menu-brand fl-c">
                            <div class="menu-item cp control fl-c w100" data-control="3">
                                <img src="./assets/icons/setting-o.svg" alt="">
                            </div>
                        </div>
                    </div>

                    <!-- login controls -->
                    <div class="w100 fl-c">
                        <div class="menu-brand fl-c">
                            <div class="menu-item">
                                <button class="auth-btn fl-c" hidden id="sign-out">
                                    <img src="./assets/icons/logOut.svg" alt="Sign Out">
                                </button>
                                <!-- <button class="auth-btn fl-c" id="sign-in">
                                    <img src="./assets/icons/logIn.svg" alt="Sign In">
                                </button> -->
                            </div>
                        </div>
                    </div>
                    <!-- login controls -->
                </div>
            </div>
        </nav>

        <main>
            <div class="container prel curr-page " id="page1" data-page="1">
                <div class="col-5 col-sm-12 groups-container h100 fl-d-cl">
                    <div class="group-sub-container w100">
                        <div class="card w100">
                            <div id="chat" class=" fl-d-cl w100 h100 scroll-y">

                            </div>
                        </div>
                    </div>
                    <div class="group-sub-container w100">
                        <div class="card w100">
                            <div id="user" class="fl-d-cl w100 h100 scroll-y">

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-7 col-sm-12 prel messages-container w100 h100 fl-d-cl">
                    <div class="card fl-d-cl w100 h100">
                        <div id="chatRoom_NULL" class="chatRoomContainer visible pabs w100 h100 fl-c">
                            Select a User to &nbsp;<span style="color: #6e00ff;font-weight: 600;"> Start
                                Chat</span>&nbsp; with.
                        </div>
                        <div class="msg-cont-head w100">
                            <span id="msg-back" class="back fl fl-c h100 cp"
                                style="transform:rotate(180deg)">&#10140;</span>
                            <div class="msg-container fl w100">
                                <div class="pic"></div>
                                <div class="data fl-d-cl">
                                    <div class="name-cont fl-j-sb w100">
                                        <div class="name">User name</div>
                                        <!-- <div class="date">last Seen: 06/01</div> -->
                                    </div>
                                    <!-- <div class="sub-msg">last Seen: unavailable</div> -->
                                </div>
                            </div>
                        </div>
                        <div class="msg-cont-body w100">
                            <div id="messages" class="scroll-y w100 fl-d-cl">

                                <!-- <div class="msg w100">
                                    <div class="msgbody">sample message</div>
                                </div>
                                <div class="msg msg-out w100">
                                    <div class="msgbody">sample message</div>
                                </div> -->

                            </div>
                        </div>
                        <form id="message-form" action="#">
                            <div class="msg-cont-footer w100">
                                <div class="prel w100 h100 fl-a-fe">
                                    <!-- <div class="input-cont w100"> -->

                                    <div id="w-input-container" class="fl-c fl-j-fs">
                                        <div>
                                            <!-- <img src="./assets/icons/image-o.svg" alt="" class="btn"> -->
                                            <input id="mediaCapture" type="file" accept="image/*" multiple
                                                class="dsp-none">
                                            <button id="submitImage" title="Add an image" class="btn image-form">
                                            </button>
                                        </div>
                                        <div id="w-input-container-sub" onclick="setFocus('message-input')">
                                            <div class="w-input-text-group">
                                                <div id="message-input" class="message-input" contenteditable></div>
                                                <div class="w-placeholder">
                                                    Type a message
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- </div> -->
                                    <button id="submit" disabled type="submit" class="btn-cont fl-c fl-a-fe">
                                        <!-- <div id="submit" disabled class="w100" type="submit"></div> -->
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="container prel" id="page2" data-page="2">
                <div id="popupFallback" class="pfx fl-c">
                    <!-- <div class="popup">
                        <div class="card w100 h100 p12 fl-c">hello</div>
                    </div> -->
                </div>
                <div class="card w100 h100 ">
                    <form class="w100 h100" id="search-form" action="#">
                        <div class="w100 h100 fl-c lhinit fl-d-cl p12">
                            <h1 class="p12 text-center">Search For User You Want to <span
                                    style="color: #6e00ff;">Start</span> Chat With</h1>

                            <div id="w-input-container" class="fl-c fl-j-fs">
                                <div id="w-input-container-sub" onclick="setFocus('user-search')">
                                    <div class="w-input-text-group">
                                        <div id="user-search" class="message-input" contenteditable></div>
                                        <div class="w-placeholder">
                                            Enter e-mail of your Freind
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button id="search-user" type="submit" class="s-btn p12 cp" disabled>Find</button>
                        </div>
                    </form>
                    <div class="pfx b0 w100 lhinit">
                        <h5 class="p12 text-center">For Security reasons, Auto-Complete/Suggestion in Search Field is
                            disabled. You can start chat only with a user whose e-mail is known to you.</h5>
                    </div>
                </div>
            </div>
            <div class="container prel" id="page3" data-page="3">
                <div class="card w100 h100 fl-c">Setting</div>
            </div>
        </main>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-messaging.js"></script>

    <script src="firebasetest.js"></script>

    <script>
        let burgerMenu = document.getElementById("burger"),
            toggle = document.getElementById("toggle"),
            nav = document.getElementById('nav'),
            fallback = document.getElementById('fallback'),
            popupFallback = document.getElementById('popupFallback'),
            navBar = document.querySelector('div.card-sm'),
            container = document.querySelector('div.container'),
            sliderHead = document.querySelectorAll('div.sliderHead'),
            sliderLine = document.querySelector('div.sliderLine'),
            groupContainer = document.querySelector('div.groups-container'),
            messagesContainer = document.querySelector('div.messages-container'),
            msgBack = document.getElementById('msg-back');


        toggle.addEventListener("click", toggleMenu);
        fallback.addEventListener('click', toggleMenu);
        // popupFallback.addEventListener('click', toggleFallback);
        msgBack.addEventListener('click', startChat);

        // function toggleFallback(){
        //     popupFallback.classList.remove('visible');
        //     fallback.classList.remove('visible');
        // }

        function toggleMenu() {
            // console.log('toggleMenu');
            // console.log(h);
            if (!popupFallback.classList.contains('visible')) {
                burgerMenu.classList.contains('active') ? (h[h.length - 1] == toggle ? h.pop() : '') : h.push(toggle);
                burgerMenu.classList.toggle("is-active");
                burgerMenu.classList.toggle("active");
                nav.classList.toggle("active");
                fallback.classList.toggle('visible');
            } else {
                // console.log('else fired');
                popupFallback.classList.contains('visible') ? h.pop() : h.push(popupFallback);
                document.querySelector('.popup').classList.remove('visible');
                popupFallback.classList.remove('visible');
                fallback.classList.remove('visible');
            }
        }


        sliderHead.forEach(div => {
            div.addEventListener('click', slide);
        });

        function slide() {
            groupContainer.classList.contains('active') ? h.pop() : h.push(sliderHead[0]);
            sliderLine.classList.toggle('active');
            groupContainer.classList.toggle('active');
        }
        setCardHeightOnMobileScreen();
        window.addEventListener('resize', setCardHeightOnMobileScreen);
        function setCardHeightOnMobileScreen() {
            if (window.innerWidth <= 768) {
                container.style.height = window.innerHeight - navBar.offsetHeight + 'px';
                container.style.marginTop = navBar.offsetHeight + 'px';
            }
        }
        function setFocus(e) {
            document.getElementById(e).focus();
        }

    </script>
</body>

</html>